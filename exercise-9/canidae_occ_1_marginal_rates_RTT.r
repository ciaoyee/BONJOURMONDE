# 1 files combined:
# 	/Users/yeechau/Downloads/exercise-9/canidae_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/Users/yeechau/Downloads/exercise-9/canidae_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.15697804606, 0.15697804606,0.15697804606,0.15697804606,0.133127089978,0.100856123911,0.040679635586,0.0286451816408,0.0286451816408,0.0331784363269,0.0331784363269,0.0331784363269,0.0331784363269,0.0286451816408,0.0343678574223,0.0388539454097,0.0662095725193,0.0891155328885,0.0899612323575,0.0899612323575,0.0899612323575,0.0985202460864,0.105755554288,0.107176083439,0.107176083439,0.107176083439,0.107176083439,0.107176083439,0.0927490313377,0.094032224116,0.107176083439,0.107176083439,0.119615264005,0.119615264005,0.145927039807,0.145927039807,0.145927039807,0.139621304842,0.139621304842,0.139621304842,0.139621304842,0.147726367661,0.138214903694,0.11647419063,0.110765150944,0.0908915832322,0.0578246266558,0.050671415081,0.050671415081,0.050671415081,0.050671415081,0.050671415081,0.050671415081,0.050671415081)
L_hpd_M95=c(0.324269685408, 0.324269685408,0.324269685408,0.324269685408,0.321144468083,0.328864718696,0.267855865513,0.142414507196,0.139621304842,0.142414507196,0.142414507196,0.142414507196,0.142414507196,0.139621304842,0.151232105823,0.172781589839,0.196841749392,0.195172290225,0.196841749392,0.196841749392,0.192308353364,0.19901376921,0.19901376921,0.197034695645,0.197034695645,0.197034695645,0.197034695645,0.206788620683,0.211331826002,0.264645998801,0.32479228924,0.383996407588,0.404914071089,0.422374860203,0.442587212275,0.442587212275,0.442587212275,0.442587212275,0.442587212275,0.442587212275,0.442587212275,0.459126760301,0.457977346297,0.438874133566,0.450237936568,0.457977346297,0.399014498752,0.399014498752,0.399014498752,0.399014498752,0.399014498752,0.399014498752,0.399014498752,0.399014498752)
M_hpd_m95=c(0.794262420671, 0.794262420671,0.0931908682041,0.0931908682041,0.0931908682041,0.0931908682041,0.0942017718212,0.0931908682041,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0942017718212,0.0931908682041,0.0821409080076,0.0571712185815,0.0485475007009,0.0475941172811,0.0440420100243,0.0440420100243,0.0440420100243,0.0440420100243,0.0435891572099,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923,0.0427958484923)
M_hpd_M95=c(1.47447454104, 1.47447454104,0.138007160345,0.138007160345,0.138007160345,0.138007160345,0.138007160345,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.136109143286,0.139083130334,0.138007160345,0.137921476034,0.132868287156,0.125703819445,0.122420272878,0.116956508756,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253,0.106204326253)
R_hpd_m95=c(-1.21707803945, -1.21707803945,0.0402642833486,0.0402642833486,0.0161193146139,-0.0195895612917,-0.07879078353,-0.0925393881531,-0.0911921759225,-0.0898535772917,-0.0898535772917,-0.0898535772917,-0.0898535772917,-0.0898535772917,-0.0846908038837,-0.0798903718177,-0.057064334801,-0.0375983824551,-0.0375983824551,-0.0375983824551,-0.0289330598467,-0.0222548794649,-0.0222548794649,-0.014527576507,-0.0173159630334,-0.0119647109829,0.0160722795167,0.0185593650984,0.0168409055053,0.0239151507409,0.0310466187133,0.0386790814961,0.0168373867445,0.0513850610414,0.0596164429979,0.0596164429979,0.0596164429979,0.0596164429979,0.0596164429979,0.0596164429979,0.0596164429979,0.0596164429979,0.0596164429979,0.0386790814961,0.0168373867445,-0.00517474507993,-0.0164566094527,-0.0229245781418,-0.0229245781418,-0.0229245781418,-0.0229245781418,-0.0229245781418,-0.0229245781418,-0.0229245781418)
R_hpd_M95=c(-0.527576796515, -0.527576796515,0.213585063759,0.213585063759,0.211208773645,0.211208773645,0.158797276243,0.0309553531693,0.022820483895,0.022820483895,0.022820483895,0.022820483895,0.022820483895,0.022820483895,0.035513288477,0.061000069701,0.0769370766991,0.0757514509966,0.0757514509966,0.0757514509966,0.0769370766991,0.0804188295773,0.0804188295773,0.089633577907,0.108611803062,0.122025397178,0.122025397178,0.131588940464,0.15588422734,0.187164865339,0.259854495087,0.334236633936,0.323701591383,0.373866944643,0.373866944643,0.373866944643,0.373866944643,0.373866944643,0.373866944643,0.373866944643,0.373866944643,0.383796040173,0.395057642348,0.378236835693,0.368187479359,0.368187479359,0.325725809661,0.325725809661,0.325725809661,0.325725809661,0.325725809661,0.325725809661,0.325725809661,0.325725809661)
L_mean=c(0.246111451176, 0.246111451176,0.246111451176,0.246111451176,0.242113874609,0.235421693959,0.138184472847,0.0743714703605,0.0738953691539,0.0737171033343,0.0737171033343,0.0737171033343,0.073778833826,0.0742718649156,0.0784724338177,0.0967108105271,0.139664893866,0.145283853968,0.146431559524,0.146431559524,0.147900569397,0.14952177168,0.151823146986,0.152562472842,0.153537632008,0.153537632008,0.153760092963,0.155217887902,0.158534808278,0.168127519785,0.196284868123,0.229506117677,0.241157887817,0.255114973211,0.276158424918,0.277063299245,0.277451662425,0.27669273943,0.276709408481,0.273744179249,0.272827539641,0.27392372812,0.270392321163,0.265859242557,0.26237210394,0.249155781548,0.227891610392,0.227574321179,0.227574321179,0.227545430521,0.227545430521,0.227545430521,0.227545430521,0.227545430521)
M_mean=c(1.14765144294, 1.14765144294,0.116098782782,0.116098782782,0.116098782782,0.116098782782,0.115983037661,0.116009307154,0.115722055254,0.115722055254,0.115722055254,0.115722055254,0.115722055254,0.115722055254,0.115691919947,0.115691919947,0.115691919947,0.115691919947,0.115691919947,0.115691919947,0.115691919947,0.115691919947,0.115154588406,0.114115105832,0.106005753361,0.0886421275365,0.081165293381,0.0783340517609,0.0740207376611,0.071209367798,0.0711083062311,0.0711419849464,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528,0.0714324011528)
R_mean=c(-0.90153999176, -0.90153999176,0.130012668394,0.130012668394,0.126015091827,0.119322911176,0.0222014351858,-0.0416378367938,-0.0418266861004,-0.04200495192,-0.04200495192,-0.04200495192,-0.0419432214283,-0.0414501903387,-0.0372194861296,-0.0189811094202,0.0239729739184,0.0295919340212,0.0307396395762,0.0307396395762,0.0322086494495,0.0338298517328,0.0366685585802,0.0384473670103,0.0475318786466,0.0648955044712,0.0725947995821,0.0768838361414,0.0845140706173,0.096918151987,0.125176561892,0.15836413273,0.169725486664,0.183682572058,0.204726023766,0.205630898092,0.206019261272,0.205260338277,0.205277007328,0.202311778096,0.201395138489,0.202491326967,0.19895992001,0.194426841404,0.190939702787,0.177723380395,0.156459209239,0.156141920026,0.156141920026,0.156113029368,0.156113029368,0.156113029368,0.156113029368,0.156113029368)
trans=0.5
age=(0:(54-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.505039436331), xlim = c(-56.7,2.7), ylab = 'Speciation rate', xlab = 'Ma',main='canidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.62192199515), xlim = c(-56.7,2.7), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.33878584339, 0.434563406583), xlim = c(-56.7,2.7), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-56.7,2.7), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()